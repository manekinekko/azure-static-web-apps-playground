<mat-drawer-container autosize appDragDrop (onFileDropped)="uploadFile($event)">
  <mat-drawer #drawer mode="side">
    <section>
      <ngx-monaco-editor
        [options]="editorOptions"
        [ngModel]="swaConfigRules"
        (ngModelChange)="onSwaConfigRulesChanged($event)"
      >
      </ngx-monaco-editor>
    </section>
  </mat-drawer>

  <div class="content">
    <button
      class="toggle-code-editor"
      type="button"
      *ngIf="swaConfigRulesResulsts"
      mat-button
      (click)="drawer.toggle()"
    >
      Open code editor
    </button>

    <section class="upload-indicator" *ngIf="!swaConfigRulesResulsts">
      <p>
        <mat-icon>cloud_upload</mat-icon>
      </p>
      <p>Drag and drop your staticwebapp.config.json file here</p>
    </section>

    <section class="route-test-container" *ngIf="swaConfigRulesResulsts">
      <mat-form-field appearance="fill" class="route-test-method">
        <mat-label>Method</mat-label>
        <mat-select value="GET">
          <mat-option value="GET">GET</mat-option>
          <mat-option value="HEAD">HEAD</mat-option>
          <mat-option value="POST">POST</mat-option>
          <mat-option value="PUT">PUT</mat-option>
          <mat-option value="DELETE">DELETE</mat-option>
          <mat-option value="CONNECT">CONNECT</mat-option>
          <mat-option value="OPTIONS">OPTIONS</mat-option>
          <mat-option value="TRACE">TRACE</mat-option>
          <mat-option value="PATCH">PATCH</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field class="route-test-input">
        <mat-label>Test Route</mat-label>
        <input
          autocomplete="off"
          matInput
          type="text"
          [(ngModel)]="testRoute"
        />
        <button
          mat-button
          *ngIf="testRoute"
          matSuffix
          mat-icon-button
          aria-label="Clear"
          (click)="testRoute = ''"
        >
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>
    </section>

    <section class="routes-inspector" *ngIf="swaConfigRulesResulsts">
      <mat-accordion multi>
        <mat-expansion-panel *ngIf="swaConfigRulesResulsts?.routes">
          <mat-expansion-panel-header>
            <mat-panel-title>Routes</mat-panel-title>
            <mat-panel-description>
              Found {{ swaConfigRulesResulsts?.$$size?.routes }} route rules
              <mat-icon>format_list_numbered</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <mat-list>
            <mat-list-item *ngFor="let route of swaConfigRulesResulsts?.routes">
              <mat-icon mat-list-icon>keyboard_arrow_right</mat-icon>
              <div mat-line>{{ route.route }}</div>
              <div mat-line *ngIf="route.statusCode">
                Response Status Code <b>{{ route.statusCode }}</b>
              </div>
              <div mat-line *ngIf="route.rewrite">
                Rewrite to <b>{{ route.rewrite }}</b>
              </div>
              <div mat-line *ngIf="route.redirect">
                Redirect to <b>{{ route.redirect }}</b>
              </div>
              <div mat-line *ngIf="route.headers">
                Headers added <b>{{ route.headers | json }}</b>
              </div>
              <div mat-line *ngIf="route.allowedRoles">
                Authorized for <b>{{ route.allowedRoles }}</b>
              </div>
              <div mat-line *ngIf="route.methods">
                Methods <b>{{ route.methods }}</b>
              </div>
            </mat-list-item>
          </mat-list>
        </mat-expansion-panel>

        <mat-expansion-panel *ngIf="swaConfigRulesResulsts?.navigationFallback">
          <mat-expansion-panel-header>
            <mat-panel-title>Fallback routes</mat-panel-title>
            <mat-panel-description>
              Fallback routes to&nbsp;
              {{ swaConfigRulesResulsts?.navigationFallback?.rewrite }}
              <mat-icon>rule</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <p>
            Rewrite all routes to
            <b>{{ swaConfigRulesResulsts?.navigationFallback?.rewrite }}</b
            >.
          </p>
          <p>
            Except files that match
            <b>{{ swaConfigRulesResulsts?.navigationFallback?.exclude }}</b
            >.
          </p>
        </mat-expansion-panel>

        <mat-expansion-panel *ngIf="swaConfigRulesResulsts?.globalHeaders">
          <mat-expansion-panel-header>
            <mat-panel-title>Global headers</mat-panel-title>
            <mat-panel-description>
              Found {{ swaConfigRulesResulsts?.$$size?.globalHeaders }} headers
              <mat-icon>http</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <mat-list>
            <mat-list-item
              *ngFor="
                let header of swaConfigRulesResulsts?.globalHeaders | keyvalue
              "
            >
              <mat-icon mat-list-icon>keyboard_arrow_right</mat-icon>
              <div mat-line>
                <span>{{ header.key }}</span>
                &nbsp;<b>{{ header.value }}</b>
              </div>
            </mat-list-item>
          </mat-list>
        </mat-expansion-panel>

        <mat-expansion-panel *ngIf="swaConfigRulesResulsts?.responseOverrides">
          <mat-expansion-panel-header>
            <mat-panel-title>Response overrides</mat-panel-title>
            <mat-panel-description>
              Found
              {{ swaConfigRulesResulsts?.$$size?.responseOverrides }} overrides
              <mat-icon>account_tree</mat-icon>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <mat-list>
            <mat-list-item
              *ngFor="
                let response of swaConfigRulesResulsts?.responseOverrides
                  | keyvalue
              "
            >
              <mat-icon mat-list-icon>keyboard_arrow_right</mat-icon>
              <div mat-line>{{ response.key }}</div>
              <div mat-line *ngIf="response.value.statusCode">
                Response Status Code <b>{{ response.value.statusCode }}</b>
              </div>
              <div mat-line *ngIf="response.value.rewrite">
                Rewrite to <b>{{ response.value.rewrite }}</b>
              </div>
              <div mat-line *ngIf="response.value.redirect">
                Redirect to <b>{{ response.value.redirect }}</b>
              </div>
            </mat-list-item>
          </mat-list>
        </mat-expansion-panel>
      </mat-accordion>
    </section>
  </div>
</mat-drawer-container>
